<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - PioneersX</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='50' y='80' font-family='Arial Black,sans-serif' font-size='90' font-weight='900' text-anchor='middle' fill='%23ff1e1e'%3EX%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
    <div class="overlay" id="overlay" onclick="closeSidebar()"></div>
    
    <div class="app">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-brand">
                    <div class="brand-logo">X</div>
                    <span class="brand-text">Pioneers<span class="x">X</span></span>
                </div>
                <button class="sidebar-close" onclick="closeSidebar()"><i class="fas fa-times"></i></button>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-group">
                    <div class="nav-group-title">Menu</div>
                    <a href="dashboard.html" class="nav-item active"><i class="fas fa-home"></i><span>Dashboard</span></a>
                    <a href="subscription.html" class="nav-item"><i class="fas fa-crown"></i><span>Subscription</span><span class="nav-badge">PRO</span></a>
                </div>
                <div class="nav-group">
                    <div class="nav-group-title">Products</div>
                    <a href="../assistx/index.html" class="nav-item" target="_blank"><i class="fas fa-robot"></i><span>AssistX</span></a>
                    <a href="../analyticsx/index.html" class="nav-item" target="_blank"><i class="fas fa-chart-line"></i><span>AnalyticsX</span></a>
                </div>
                <div class="nav-group">
                    <div class="nav-group-title">Account</div>
                    <a href="profile.html" class="nav-item"><i class="fas fa-user"></i><span>Profile</span></a>
                    <a href="settings.html" class="nav-item"><i class="fas fa-cog"></i><span>Settings</span></a>
                    <a href="../index.html" class="nav-item" target="_blank"><i class="fas fa-external-link-alt"></i><span>Main Website</span></a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-menu" onclick="logout()">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-details">
                        <div class="user-name" id="userName">User</div>
                        <div class="user-email" id="userEmail">user@email.com</div>
                    </div>
                    <i class="fas fa-sign-out-alt user-menu-icon"></i>
                </div>
            </div>
        </aside>
        
        <main class="main">
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" onclick="openSidebar()"><i class="fas fa-bars"></i></button>
                    <h1 class="page-title">Dashboard</h1>
                </div>
                <div class="header-right">
                    <button class="header-btn"><i class="fas fa-bell"></i><span class="badge"></span></button>
                    <button class="header-btn"><i class="fas fa-question-circle"></i></button>
                </div>
            </header>
            
            <div class="content">
                <div class="welcome">
                    <h1 class="welcome-title">Welcome back, <span id="welcomeName">User</span>! ðŸ‘‹</h1>
                    <p class="welcome-subtitle">Here's what's happening with your account today.</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header"><div class="stat-icon"><i class="fas fa-crown"></i></div></div>
                        <div class="stat-value" id="activeSubscriptions">0</div>
                        <div class="stat-label">Active Subscriptions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header"><div class="stat-icon green"><i class="fas fa-envelope"></i></div></div>
                        <div class="stat-value" id="emailStatus" style="font-size: 1.2rem;">Not Verified</div>
                        <div class="stat-label">Email Status</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header"><div class="stat-icon blue"><i class="fas fa-box"></i></div></div>
                        <div class="stat-value">2</div>
                        <div class="stat-label">Available Products</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-bolt"></i> Quick Actions</h2>
                    </div>
                    <div class="card-body">
                        <div class="actions-grid">
                            <a href="subscription.html" class="action-card">
                                <div class="action-icon"><i class="fas fa-crown"></i></div>
                                <div class="action-title">Upgrade Plan</div>
                                <div class="action-desc">Get more features</div>
                            </a>
                            <a href="profile.html" class="action-card">
                                <div class="action-icon"><i class="fas fa-user-edit"></i></div>
                                <div class="action-title">Edit Profile</div>
                                <div class="action-desc">Update your info</div>
                            </a>
                            <a href="../assistx/index.html" target="_blank" class="action-card">
                                <div class="action-icon"><i class="fas fa-robot"></i></div>
                                <div class="action-title">Open AssistX</div>
                                <div class="action-desc">AI Assistant</div>
                            </a>
                            <a href="../analyticsx/index.html" target="_blank" class="action-card">
                                <div class="action-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="action-title">Open AnalyticsX</div>
                                <div class="action-desc">Business Analytics</div>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-box-open"></i> Our Products</h2>
                        <a href="subscription.html" class="btn btn-ghost btn-sm">View Plans <i class="fas fa-arrow-right"></i></a>
                    </div>
                    <div class="card-body">
                        <div class="products-grid">
                            <div class="product-card">
                                <div class="product-header">
                                    <div class="product-icon"><i class="fas fa-robot"></i></div>
                                    <span class="product-badge">Popular</span>
                                </div>
                                <h3 class="product-name">Assist<span class="x">X</span></h3>
                                <p class="product-desc">Access 15+ AI models including ChatGPT, Claude, Perplexity and more - all in one place.</p>
                                <div class="product-features">
                                    <span class="product-feature">ChatGPT</span>
                                    <span class="product-feature">Claude</span>
                                    <span class="product-feature">Perplexity</span>
                                    <span class="product-feature">+12 more</span>
                                </div>
                                <div class="product-footer">
                                    <span class="product-price">$25<span>/month</span></span>
                                    <a href="subscription.html" class="btn btn-primary btn-sm">Subscribe</a>
                                </div>
                            </div>
                            <div class="product-card">
                                <div class="product-header">
                                    <div class="product-icon"><i class="fas fa-chart-line"></i></div>
                                    <span class="product-badge">New</span>
                                </div>
                                <h3 class="product-name">Analytics<span class="x">X</span></h3>
                                <p class="product-desc">Smart business analytics powered by AI. Get insights, automated reports, and predictions.</p>
                                <div class="product-features">
                                    <span class="product-feature">Dashboards</span>
                                    <span class="product-feature">Reports</span>
                                    <span class="product-feature">AI Insights</span>
                                    <span class="product-feature">Predictions</span>
                                </div>
                                <div class="product-footer">
                                    <span class="product-price">$149<span>/month</span></span>
                                    <a href="subscription.html" class="btn btn-primary btn-sm">Subscribe</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-receipt"></i> Your Subscriptions</h2>
                    </div>
                    <div class="card-body" id="subscriptionsList">
                        <div class="empty-state">
                            <div class="empty-state-icon"><i class="fas fa-inbox"></i></div>
                            <h3 class="empty-state-title">No active subscriptions</h3>
                            <p class="empty-state-desc">Subscribe to a plan to unlock premium features</p>
                            <a href="subscription.html" class="btn btn-primary">Subscribe Now</a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script src="js/api.js"></script>
    <script>
        if (!API.isLoggedIn()) window.location.href = 'index.html';
        
        async function loadDashboard() {
            const user = API.getUser();
            if (user) {
                document.getElementById('welcomeName').textContent = user.firstName || 'User';
                document.getElementById('userName').textContent = `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'User';
                document.getElementById('userEmail').textContent = user.email || '';
                document.getElementById('userAvatar').textContent = (user.firstName ? user.firstName[0] : 'U').toUpperCase();
                const emailStatus = document.getElementById('emailStatus');
                emailStatus.textContent = user.isEmailVerified ? 'Verified âœ“' : 'Not Verified';
                emailStatus.style.color = user.isEmailVerified ? 'var(--success)' : 'var(--warning)';
            }
            
            const result = await API.getMySubscriptions();
            if (result.success && result.data && result.data.length > 0) {
                document.getElementById('activeSubscriptions').textContent = result.data.filter(s => s.status === 'active').length;
                document.getElementById('subscriptionsList').innerHTML = result.data.map(sub => `
                    <div style="display:flex;align-items:center;justify-content:space-between;padding:16px;background:var(--bg-tertiary);border-radius:var(--radius-md);margin-bottom:12px;">
                        <div><h4 style="font-weight:600;margin-bottom:4px;">${sub.product || 'Subscription'}</h4><p style="font-size:0.85rem;color:var(--text-muted);">${sub.plan || 'Plan'} â€¢ ${sub.billingCycle || 'Monthly'}</p></div>
                        <span style="background:${sub.status === 'active' ? 'rgba(34,197,94,0.1)' : 'rgba(234,179,8,0.1)'};color:${sub.status === 'active' ? 'var(--success)' : 'var(--warning)'};padding:4px 12px;border-radius:var(--radius-full);font-size:0.75rem;font-weight:600;">${sub.status === 'active' ? 'Active' : sub.status}</span>
                    </div>`).join('');
            }
        }
        
        function openSidebar() { document.getElementById('sidebar').classList.add('open'); document.getElementById('overlay').classList.add('show'); }
        function closeSidebar() { document.getElementById('sidebar').classList.remove('open'); document.getElementById('overlay').classList.remove('show'); }
        function logout() { API.logout(); window.location.href = 'index.html'; }
        
        loadDashboard();
    </script>
</body>
</html>
