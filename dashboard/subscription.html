<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscription - PioneersX</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='50' y='80' font-family='Arial Black,sans-serif' font-size='90' font-weight='900' text-anchor='middle' fill='%23ff1e1e'%3EX%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
    <div class="overlay" id="overlay" onclick="closeSidebar()"></div>
    <div class="app">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-brand"><div class="brand-logo">X</div><span class="brand-text">Pioneers<span class="x">X</span></span></div>
                <button class="sidebar-close" onclick="closeSidebar()"><i class="fas fa-times"></i></button>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-group">
                    <div class="nav-group-title">Menu</div>
                    <a href="dashboard.html" class="nav-item"><i class="fas fa-home"></i><span>Dashboard</span></a>
                    <a href="subscription.html" class="nav-item active"><i class="fas fa-crown"></i><span>Subscription</span><span class="nav-badge">PRO</span></a>
                </div>
                <div class="nav-group">
                    <div class="nav-group-title">Account</div>
                    <a href="profile.html" class="nav-item"><i class="fas fa-user"></i><span>Profile</span></a>
                    <a href="settings.html" class="nav-item"><i class="fas fa-cog"></i><span>Settings</span></a>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="user-menu" onclick="logout()">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-details"><div class="user-name" id="userName">User</div><div class="user-email" id="userEmail">user@email.com</div></div>
                    <i class="fas fa-sign-out-alt user-menu-icon"></i>
                </div>
            </div>
        </aside>
        
        <main class="main">
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" onclick="openSidebar()"><i class="fas fa-bars"></i></button>
                    <h1 class="page-title">Subscription</h1>
                </div>
            </header>
            
            <div class="content">
                <div class="alert" id="alert" style="margin-bottom:24px;"></div>
                
                <div class="card" style="margin-bottom:32px;">
                    <div class="card-header"><h2 class="card-title"><i class="fas fa-box"></i> Select Product</h2></div>
                    <div class="card-body">
                        <div style="display:flex;gap:16px;flex-wrap:wrap;">
                            <button class="btn btn-primary product-selector active" data-product="assistx" onclick="selectProduct('assistx')"><i class="fas fa-robot"></i> AssistX</button>
                            <button class="btn btn-secondary product-selector" data-product="analyticsx" onclick="selectProduct('analyticsx')"><i class="fas fa-chart-line"></i> AnalyticsX</button>
                        </div>
                    </div>
                </div>
                
                <div class="pricing-header">
                    <h2 class="pricing-title">Choose your plan</h2>
                    <div class="billing-toggle">
                        <button class="billing-btn active" id="monthlyBtn" onclick="setBilling('monthly')">Monthly</button>
                        <button class="billing-btn" id="yearlyBtn" onclick="setBilling('yearly')">Yearly <span class="save-badge">-20%</span></button>
                    </div>
                </div>
                
                <div id="assistx-plans" class="pricing-grid">
                    <div class="pricing-card">
                        <h3 class="pricing-name">Vort<span class="x">X</span></h3>
                        <div class="pricing-price">$<span class="price-value" data-monthly="25" data-yearly="20">25</span><span>/mo</span></div>
                        <p class="pricing-desc">Perfect for individuals</p>
                        <ul class="pricing-features">
                            <li><i class="fas fa-check"></i> 5 AI Models</li>
                            <li><i class="fas fa-check"></i> 1,000 messages/month</li>
                            <li><i class="fas fa-check"></i> Basic Support</li>
                            <li><i class="fas fa-check"></i> Web Access</li>
                        </ul>
                        <button class="btn btn-outline btn-block" onclick="subscribe('assistx','vortx')">Get Started</button>
                    </div>
                    <div class="pricing-card popular">
                        <h3 class="pricing-name">Quant<span class="x">X</span></h3>
                        <div class="pricing-price">$<span class="price-value" data-monthly="50" data-yearly="40">50</span><span>/mo</span></div>
                        <p class="pricing-desc">Best for professionals</p>
                        <ul class="pricing-features">
                            <li><i class="fas fa-check"></i> 10 AI Models</li>
                            <li><i class="fas fa-check"></i> 5,000 messages/month</li>
                            <li><i class="fas fa-check"></i> Priority Support</li>
                            <li><i class="fas fa-check"></i> API Access</li>
                            <li><i class="fas fa-check"></i> Custom Prompts</li>
                        </ul>
                        <button class="btn btn-primary btn-block" onclick="subscribe('assistx','quantx')">Get Started</button>
                    </div>
                    <div class="pricing-card">
                        <h3 class="pricing-name">Infin<span class="x">X</span></h3>
                        <div class="pricing-price">$<span class="price-value" data-monthly="99" data-yearly="79">99</span><span>/mo</span></div>
                        <p class="pricing-desc">For power users</p>
                        <ul class="pricing-features">
                            <li><i class="fas fa-check"></i> All 15+ AI Models</li>
                            <li><i class="fas fa-check"></i> Unlimited Messages</li>
                            <li><i class="fas fa-check"></i> 24/7 VIP Support</li>
                            <li><i class="fas fa-check"></i> Full API Access</li>
                            <li><i class="fas fa-check"></i> Team Collaboration</li>
                        </ul>
                        <button class="btn btn-outline btn-block" onclick="subscribe('assistx','infinx')">Get Started</button>
                    </div>
                </div>
                
                <div id="analyticsx-plans" class="pricing-grid" style="display:none;">
                    <div class="pricing-card">
                        <h3 class="pricing-name">Starter<span class="x">X</span></h3>
                        <div class="pricing-price">$<span class="price-value" data-monthly="149" data-yearly="119">149</span><span>/mo</span></div>
                        <p class="pricing-desc">For small businesses</p>
                        <ul class="pricing-features">
                            <li><i class="fas fa-check"></i> 5 Data Sources</li>
                            <li><i class="fas fa-check"></i> Basic Dashboards</li>
                            <li><i class="fas fa-check"></i> Weekly Reports</li>
                            <li><i class="fas fa-check"></i> Email Support</li>
                        </ul>
                        <button class="btn btn-outline btn-block" onclick="subscribe('analyticsx','starterx')">Get Started</button>
                    </div>
                    <div class="pricing-card popular">
                        <h3 class="pricing-name">Business<span class="x">X</span></h3>
                        <div class="pricing-price">$<span class="price-value" data-monthly="299" data-yearly="239">299</span><span>/mo</span></div>
                        <p class="pricing-desc">For growing companies</p>
                        <ul class="pricing-features">
                            <li><i class="fas fa-check"></i> 20 Data Sources</li>
                            <li><i class="fas fa-check"></i> Advanced Dashboards</li>
                            <li><i class="fas fa-check"></i> Daily Reports</li>
                            <li><i class="fas fa-check"></i> AI Insights</li>
                            <li><i class="fas fa-check"></i> Priority Support</li>
                        </ul>
                        <button class="btn btn-primary btn-block" onclick="subscribe('analyticsx','businessx')">Get Started</button>
                    </div>
                    <div class="pricing-card">
                        <h3 class="pricing-name">Enterprise<span class="x">X</span></h3>
                        <div class="pricing-price">$<span class="price-value" data-monthly="599" data-yearly="479">599</span><span>/mo</span></div>
                        <p class="pricing-desc">For large organizations</p>
                        <ul class="pricing-features">
                            <li><i class="fas fa-check"></i> Unlimited Data Sources</li>
                            <li><i class="fas fa-check"></i> Custom Dashboards</li>
                            <li><i class="fas fa-check"></i> Real-time Reports</li>
                            <li><i class="fas fa-check"></i> Predictive Analytics</li>
                            <li><i class="fas fa-check"></i> Dedicated Support</li>
                        </ul>
                        <button class="btn btn-outline btn-block" onclick="subscribe('analyticsx','enterprisex')">Get Started</button>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script src="js/api.js"></script>
    <script>
        if (!API.isLoggedIn()) window.location.href = 'index.html';
        let currentBilling = 'monthly';
        
        function loadUser() {
            const user = API.getUser();
            if (user) {
                document.getElementById('userName').textContent = `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'User';
                document.getElementById('userEmail').textContent = user.email || '';
                document.getElementById('userAvatar').textContent = (user.firstName ? user.firstName[0] : 'U').toUpperCase();
            }
        }
        
        function selectProduct(product) {
            document.querySelectorAll('.product-selector').forEach(btn => { btn.classList.remove('btn-primary','active'); btn.classList.add('btn-secondary'); });
            document.querySelector(`[data-product="${product}"]`).classList.remove('btn-secondary');
            document.querySelector(`[data-product="${product}"]`).classList.add('btn-primary','active');
            document.getElementById('assistx-plans').style.display = product === 'assistx' ? 'grid' : 'none';
            document.getElementById('analyticsx-plans').style.display = product === 'analyticsx' ? 'grid' : 'none';
        }
        
        function setBilling(billing) {
            currentBilling = billing;
            document.getElementById('monthlyBtn').classList.toggle('active', billing === 'monthly');
            document.getElementById('yearlyBtn').classList.toggle('active', billing === 'yearly');
            document.querySelectorAll('.price-value').forEach(el => { el.textContent = el.dataset[billing]; });
        }
        
        async function subscribe(product, plan) {
            const alert = document.getElementById('alert');
            alert.className = 'alert alert-success show';
            alert.innerHTML = '<span class="spinner"></span> Processing...';
            const result = await API.createOrder(product, plan, currentBilling);
            if (result.success && result.data && result.data.approvalUrl) {
                alert.innerHTML = '<i class="fas fa-check-circle"></i> Redirecting to PayPal...';
                window.location.href = result.data.approvalUrl;
            } else {
                alert.className = 'alert alert-error show';
                alert.innerHTML = '<i class="fas fa-exclamation-circle"></i> ' + (result.message || 'Failed');
            }
        }
        
        function openSidebar() { document.getElementById('sidebar').classList.add('open'); document.getElementById('overlay').classList.add('show'); }
        function closeSidebar() { document.getElementById('sidebar').classList.remove('open'); document.getElementById('overlay').classList.remove('show'); }
        function logout() { API.logout(); window.location.href = 'index.html'; }
        
        loadUser();
    </script>
</body>
</html>
